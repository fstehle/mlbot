service: mlbot

provider:
  name: aws
  runtime: python3.7
  memorySize: 512 # memory >=512 MB has much more predictable performance
  timeout: 10
  region: eu-west-1
  environment:
    EndpointName: ${self:custom.sagemakerEndpointName}
  iamRoleStatements:
    -  Effect: "Allow"
       Action:
         - "sagemaker:InvokeEndpoint"
       Resource: "arn:aws:sagemaker:eu-west-1:840574570967:endpoint/${self:custom.sagemakerEndpointName}"
    -  Effect: "Allow"
       Action:
         - "rekognition:DetectLabels"
       Resource: "*"

custom:
  sagemakerEndpointName: mlbot-classify-ep--2019-02-14-09-16-45

functions:
  classify:
    handler: classify.lambda_handler
  detect:
    handler: detect.lambda_handler
